# äº¤æ˜“ç³»ç»ŸUIè®¾è®¡è¡¥å…… - æŒä»“ä¸äº¤æ˜“æ¨¡å—

## ğŸ“‹ **è®¾è®¡æ¦‚è¿°**

è¡¥å……åŸè®¾è®¡æ–‡æ¡£ä¸­ç¼ºå¤±çš„äº¤æ˜“ç›¸å…³UIï¼ŒåŒ…æ‹¬ï¼š
1. âœ… æŒä»“ç®¡ç†é¢æ¿
2. âœ… äº¤æ˜“æ‰§è¡Œç•Œé¢
3. âœ… è®¢å•ç®¡ç†ç³»ç»Ÿ
4. âœ… è‡ªåŠ¨äº¤æ˜“æ§åˆ¶
5. âœ… è´¦æˆ·ä¿¡æ¯å±•ç¤º
6. âœ… äº¤æ˜“å†å²è®°å½•

---

## ğŸ¨ **å®Œæ•´ä¸»çª—å£å¸ƒå±€ï¼ˆå¢å¼ºç‰ˆï¼‰**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  èœå•æ : æ–‡ä»¶ | ç­–ç•¥ | äº¤æ˜“ | è‡ªåŠ¨åŒ– | å·¥å…· | å¸®åŠ©                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  å·¥å…·æ : [è¿æ¥] [åˆ·æ–°] [å›æµ‹] [æ‰‹åŠ¨äº¤æ˜“] [è‡ªåŠ¨äº¤æ˜“] [ç­–ç•¥] [è®¾ç½®]     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚         â”‚                                 â”‚  ğŸ“Š æŒä»“ | è®¢å• | è´¦æˆ·    â”‚
â”‚ è‚¡ç¥¨åˆ—è¡¨â”‚       Kçº¿å›¾ + æŒ‡æ ‡               â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”â”‚                                 â”‚ â”‚ğŸŸ¢ TSLA    100è‚¡    â”‚  â”‚
â”‚ â”‚TSLA â”‚â”‚                                 â”‚ â”‚  æˆæœ¬: $420.00     â”‚  â”‚
â”‚ â”‚NVDA â”‚â”‚                                 â”‚ â”‚  ç°ä»·: $442.50     â”‚  â”‚
â”‚ â”‚AAPL â”‚â”‚  [ä¸»å›¾] [å‰¯å›¾] [æˆäº¤é‡]         â”‚ â”‚  ç›ˆäº: +$2,250     â”‚  â”‚
â”‚ â”‚01797â”‚â”‚                                 â”‚ â”‚  æ”¶ç›Šç‡: +5.36%    â”‚  â”‚
â”‚ â”‚600519                                 â”‚ â”‚  [å¹³ä»“] [åŠ ä»“]     â”‚  â”‚
â”‚ â””â”€â”€â”€â”€â”€â”˜â”‚                                 â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚        â”‚                                 â”‚ ğŸ”´ NVDA    50è‚¡        â”‚
â”‚ è‡ªé€‰è‚¡ â”‚                                 â”‚   æˆæœ¬: $880.00        â”‚
â”‚ [æ–°å¢] â”‚                                 â”‚   ç°ä»·: $855.00        â”‚
â”‚ [åˆ é™¤] â”‚                                 â”‚   ç›ˆäº: -$1,250        â”‚
â”‚        â”‚                                 â”‚   æ”¶ç›Šç‡: -2.84%       â”‚
â”‚ å¸‚åœº   â”‚                                 â”‚   [å¹³ä»“] [åŠ ä»“]        â”‚
â”‚ â—‹ ç¾è‚¡ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                        â”‚
â”‚ â—‹ æ¸¯è‚¡ â”‚  æ ‡ç­¾é¡µ: [ä¿¡å·] [äº¤æ˜“] [æŒä»“]  â”‚  ğŸ“ˆ è´¦æˆ·æ€»è§ˆ           â”‚
â”‚ â—‹ Aè‚¡  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚ æ€»èµ„äº§: $150,000.00   â”‚
â”‚        â”‚ â”‚ğŸŸ¢ [ä¿¡å·é¢æ¿]               â”‚   â”‚ å¯ç”¨: $48,000.00      â”‚
â”‚        â”‚ â”‚  TSLA ä¹°å…¥ä¿¡å·             â”‚   â”‚ æŒä»“: $102,000.00     â”‚
â”‚ å›æµ‹   â”‚ â”‚  TSF > LSMA + 0.5%        â”‚   â”‚ ç›ˆäº: +$2,000 (+1.35%)â”‚
â”‚        â”‚ â”‚  å»ºè®®ä»·: $440-$445        â”‚   â”‚                        â”‚
â”‚ ç­–ç•¥   â”‚ â”‚  [ç«‹å³äº¤æ˜“] [æŸ¥çœ‹è¯¦æƒ…]     â”‚   â”‚  ä»Šæ—¥äº¤æ˜“              â”‚
â”‚        â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚ ä¹°å…¥: 2ç¬”              â”‚
â”‚ å®šæ—¶ä»»åŠ¡â”‚ğŸŸ¡ [äº¤æ˜“é¢æ¿]              â”‚   â”‚ å–å‡º: 1ç¬”              â”‚
â”‚        â”‚ â”‚  å¿«é€Ÿä¸‹å•                  â”‚   â”‚ æˆäº¤: 3ç¬”              â”‚
â”‚        â”‚ â”‚  è‚¡ç¥¨: [TSLA    â–¼]        â”‚   â”‚ å¾…æˆäº¤: 0ç¬”            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚  æ“ä½œ: [ä¹°å…¥ â–¼] [å–å‡º]   â”‚   â”‚                        â”‚
â”‚  æ—¥å¿—   â”‚  â”‚  æ•°é‡: [100]   è‚¡         â”‚   â”‚  æœ€æ–°æ–°é—»              â”‚
â”‚         â”‚  â”‚  ä»·æ ¼: [å¸‚ä»· â–¼] [$442.50]â”‚   â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚ [æ¸…ç©º]  â”‚  â”‚  [æäº¤è®¢å•]               â”‚   â”‚ â”‚Tesla Q4è´¢æŠ¥è¶…é¢„æœŸâ”‚   â”‚
â”‚         â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚ â”‚ç‰¹æ–¯æ‹‰å‘å¸ƒæ–°è½¦å‹   â”‚   â”‚
â”‚         â”‚ ğŸ”µ [æŒä»“è¯¦æƒ…]              â”‚   â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚         â”‚  â”‚å½“å‰æŒä»“: 2åªè‚¡ç¥¨          â”‚   â”‚                        â”‚
â”‚         â”‚  â”‚æ€»æˆæœ¬: $102,000          â”‚   â”‚  è‡ªåŠ¨äº¤æ˜“              â”‚
â”‚         â”‚  â”‚æ€»å¸‚å€¼: $104,000          â”‚   â”‚ â—‹ è‡ªåŠ¨äº¤æ˜“å·²å…³é—­      â”‚
â”‚         â”‚  â”‚æµ®åŠ¨ç›ˆäº: +$2,000         â”‚   â”‚ [å¯åŠ¨è‡ªåŠ¨äº¤æ˜“]         â”‚
â”‚         â”‚  â”‚[æŸ¥çœ‹è¯¦æƒ…] [å¯¼å‡ºæŠ¥è¡¨]     â”‚   â”‚                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ çŠ¶æ€æ : ğŸŸ¢ å·²è¿æ¥Futu | è´¦æˆ·: æ¨¡æ‹Ÿç›˜ | CPU: 5% | å†…å­˜: 2.1GB | 16:30 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ’¼ **1. æŒä»“ç®¡ç†é¢æ¿ (Position Widget)**

### **UIç»„ä»¶è®¾è®¡**

```python
"""
æŒä»“ç®¡ç†é¢æ¿
ui/widgets/position_widget.py
"""
from PyQt6.QtWidgets import (QWidget, QVBoxLayout, QHBoxLayout, 
                             QTableWidget, QLabel, QPushButton,
                             QGroupBox, QTableWidgetItem, QHeaderView)
from PyQt6.QtCore import Qt, pyqtSignal
from PyQt6.QtGui import QColor


class PositionWidget(QWidget):
    """æŒä»“ç®¡ç†é¢æ¿"""
    
    # ä¿¡å·
    close_position = pyqtSignal(str, int)  # å¹³ä»“ä¿¡å·ï¼ˆè‚¡ç¥¨ä»£ç ï¼Œæ•°é‡ï¼‰
    add_position = pyqtSignal(str)          # åŠ ä»“ä¿¡å·
    
    def __init__(self):
        super().__init__()
        self.init_ui()
    
    def init_ui(self):
        """åˆå§‹åŒ–UI"""
        layout = QVBoxLayout(self)
        
        # æ ‡é¢˜æ 
        title_layout = QHBoxLayout()
        title = QLabel("ğŸ“Š æŒä»“ç®¡ç†")
        title.setStyleSheet("font-size: 16px; font-weight: bold;")
        title_layout.addWidget(title)
        
        refresh_btn = QPushButton("ğŸ”„ åˆ·æ–°")
        refresh_btn.clicked.connect(self.refresh_positions)
        title_layout.addWidget(refresh_btn)
        
        title_layout.addStretch()
        layout.addLayout(title_layout)
        
        # æŒä»“ç»Ÿè®¡
        stats_group = QGroupBox("æŒä»“ç»Ÿè®¡")
        stats_layout = QHBoxLayout()
        
        self.total_cost_label = QLabel("æ€»æˆæœ¬: $0.00")
        self.total_value_label = QLabel("æ€»å¸‚å€¼: $0.00")
        self.total_profit_label = QLabel("æµ®åŠ¨ç›ˆäº: $0.00 (0.00%)")
        
        stats_layout.addWidget(self.total_cost_label)
        stats_layout.addWidget(self.total_value_label)
        stats_layout.addWidget(self.total_profit_label)
        stats_layout.addStretch()
        
        stats_group.setLayout(stats_layout)
        layout.addWidget(stats_group)
        
        # æŒä»“åˆ—è¡¨è¡¨æ ¼
        self.position_table = QTableWidget()
        self.position_table.setColumnCount(10)
        self.position_table.setHorizontalHeaderLabels([
            'è‚¡ç¥¨ä»£ç ', 'è‚¡ç¥¨åç§°', 'æŒä»“æ•°é‡', 'å¯ç”¨æ•°é‡', 
            'æˆæœ¬ä»·', 'ç°ä»·', 'å¸‚å€¼', 'ç›ˆäºé‡‘é¢', 'ç›ˆäºæ¯”ä¾‹', 'æ“ä½œ'
        ])
        
        # è‡ªåŠ¨è°ƒæ•´åˆ—å®½
        header = self.position_table.horizontalHeader()
        header.setSectionResizeMode(QHeaderView.ResizeMode.Stretch)
        
        layout.addWidget(self.position_table)
        
        # åº•éƒ¨æŒ‰é’®
        button_layout = QHBoxLayout()
        
        export_btn = QPushButton("ğŸ“¤ å¯¼å‡ºæŒä»“")
        export_btn.clicked.connect(self.export_positions)
        button_layout.addWidget(export_btn)
        
        close_all_btn = QPushButton("ğŸ”´ æ¸…ç©ºæ‰€æœ‰æŒä»“")
        close_all_btn.setStyleSheet("color: red;")
        close_all_btn.clicked.connect(self.close_all_positions)
        button_layout.addWidget(close_all_btn)
        
        button_layout.addStretch()
        layout.addLayout(button_layout)
    
    def update_positions(self, positions):
        """
        æ›´æ–°æŒä»“æ•°æ®
        
        Parameters:
        -----------
        positions : list
            æŒä»“åˆ—è¡¨
            [{
                'code': 'TSLA',
                'name': 'ç‰¹æ–¯æ‹‰',
                'qty': 100,
                'available_qty': 100,
                'cost_price': 420.00,
                'current_price': 442.50,
                'market_value': 44250.00,
                'profit': 2250.00,
                'profit_rate': 5.36
            }, ...]
        """
        self.position_table.setRowCount(0)
        
        total_cost = 0
        total_value = 0
        
        for position in positions:
            row = self.position_table.rowCount()
            self.position_table.insertRow(row)
            
            # è‚¡ç¥¨ä»£ç 
            self.position_table.setItem(row, 0, QTableWidgetItem(position['code']))
            
            # è‚¡ç¥¨åç§°
            self.position_table.setItem(row, 1, QTableWidgetItem(position['name']))
            
            # æŒä»“æ•°é‡
            self.position_table.setItem(row, 2, QTableWidgetItem(str(position['qty'])))
            
            # å¯ç”¨æ•°é‡
            self.position_table.setItem(row, 3, QTableWidgetItem(str(position['available_qty'])))
            
            # æˆæœ¬ä»·
            self.position_table.setItem(row, 4, QTableWidgetItem(f"${position['cost_price']:.2f}"))
            
            # ç°ä»·
            self.position_table.setItem(row, 5, QTableWidgetItem(f"${position['current_price']:.2f}"))
            
            # å¸‚å€¼
            self.position_table.setItem(row, 6, QTableWidgetItem(f"${position['market_value']:.2f}"))
            
            # ç›ˆäºé‡‘é¢
            profit_item = QTableWidgetItem(f"${position['profit']:+.2f}")
            profit_item.setForeground(QColor('green' if position['profit'] > 0 else 'red'))
            self.position_table.setItem(row, 7, profit_item)
            
            # ç›ˆäºæ¯”ä¾‹
            profit_rate_item = QTableWidgetItem(f"{position['profit_rate']:+.2f}%")
            profit_rate_item.setForeground(QColor('green' if position['profit_rate'] > 0 else 'red'))
            self.position_table.setItem(row, 8, profit_rate_item)
            
            # æ“ä½œæŒ‰é’®
            button_widget = QWidget()
            button_layout = QHBoxLayout(button_widget)
            button_layout.setContentsMargins(2, 2, 2, 2)
            
            close_btn = QPushButton("å¹³ä»“")
            close_btn.clicked.connect(lambda checked, code=position['code'], qty=position['available_qty']: 
                                     self.close_position.emit(code, qty))
            button_layout.addWidget(close_btn)
            
            add_btn = QPushButton("åŠ ä»“")
            add_btn.clicked.connect(lambda checked, code=position['code']: 
                                   self.add_position.emit(code))
            button_layout.addWidget(add_btn)
            
            self.position_table.setCellWidget(row, 9, button_widget)
            
            # ç»Ÿè®¡
            total_cost += position['cost_price'] * position['qty']
            total_value += position['market_value']
        
        # æ›´æ–°ç»Ÿè®¡ä¿¡æ¯
        total_profit = total_value - total_cost
        profit_rate = (total_profit / total_cost * 100) if total_cost > 0 else 0
        
        self.total_cost_label.setText(f"æ€»æˆæœ¬: ${total_cost:,.2f}")
        self.total_value_label.setText(f"æ€»å¸‚å€¼: ${total_value:,.2f}")
        
        profit_text = f"æµ®åŠ¨ç›ˆäº: ${total_profit:+,.2f} ({profit_rate:+.2f}%)"
        self.total_profit_label.setText(profit_text)
        self.total_profit_label.setStyleSheet(
            f"color: {'green' if total_profit > 0 else 'red'}; font-weight: bold;"
        )
    
    def refresh_positions(self):
        """åˆ·æ–°æŒä»“"""
        # TODO: ä»äº¤æ˜“å¼•æ“è·å–æœ€æ–°æŒä»“
        pass
    
    def export_positions(self):
        """å¯¼å‡ºæŒä»“"""
        # TODO: å¯¼å‡ºä¸ºCSVæˆ–Excel
        pass
    
    def close_all_positions(self):
        """æ¸…ç©ºæ‰€æœ‰æŒä»“"""
        # TODO: ç¡®è®¤å¯¹è¯æ¡† + æ‰¹é‡å¹³ä»“
        pass
```

---

## ğŸ”„ **2. äº¤æ˜“æ‰§è¡Œé¢æ¿ (Trade Widget)**

### **UIç»„ä»¶è®¾è®¡**

```python
"""
äº¤æ˜“æ‰§è¡Œé¢æ¿
ui/widgets/trade_widget.py
"""
from PyQt6.QtWidgets import (QWidget, QVBoxLayout, QHBoxLayout, QFormLayout,
                             QLabel, QLineEdit, QComboBox, QPushButton,
                             QSpinBox, QDoubleSpinBox, QGroupBox, QRadioButton,
                             QButtonGroup, QMessageBox)
from PyQt6.QtCore import Qt, pyqtSignal


class TradeWidget(QWidget):
    """äº¤æ˜“æ‰§è¡Œé¢æ¿"""
    
    # ä¿¡å·
    order_submitted = pyqtSignal(dict)  # è®¢å•æäº¤ä¿¡å·
    
    def __init__(self):
        super().__init__()
        self.init_ui()
    
    def init_ui(self):
        """åˆå§‹åŒ–UI"""
        layout = QVBoxLayout(self)
        
        # æ ‡é¢˜
        title = QLabel("ğŸ”„ å¿«é€Ÿäº¤æ˜“")
        title.setStyleSheet("font-size: 16px; font-weight: bold;")
        layout.addWidget(title)
        
        # äº¤æ˜“è¡¨å•
        form_group = QGroupBox("ä¸‹å•ä¿¡æ¯")
        form_layout = QFormLayout()
        
        # è‚¡ç¥¨ä»£ç 
        self.stock_code_input = QComboBox()
        self.stock_code_input.setEditable(True)
        self.stock_code_input.setPlaceholderText("è¾“å…¥æˆ–é€‰æ‹©è‚¡ç¥¨ä»£ç ")
        form_layout.addRow("è‚¡ç¥¨ä»£ç :", self.stock_code_input)
        
        # ä¹°å–æ–¹å‘
        direction_layout = QHBoxLayout()
        self.buy_radio = QRadioButton("ä¹°å…¥")
        self.sell_radio = QRadioButton("å–å‡º")
        self.buy_radio.setChecked(True)
        
        direction_group = QButtonGroup()
        direction_group.addButton(self.buy_radio)
        direction_group.addButton(self.sell_radio)
        
        direction_layout.addWidget(self.buy_radio)
        direction_layout.addWidget(self.sell_radio)
        direction_layout.addStretch()
        form_layout.addRow("äº¤æ˜“æ–¹å‘:", direction_layout)
        
        # ä»·æ ¼ç±»å‹
        self.price_type_combo = QComboBox()
        self.price_type_combo.addItems(["å¸‚ä»·", "é™ä»·", "æœ€ä¼˜äº”æ¡£", "æœ€ä¼˜å¯¹æ‰‹ä»·"])
        self.price_type_combo.currentTextChanged.connect(self.on_price_type_changed)
        form_layout.addRow("ä»·æ ¼ç±»å‹:", self.price_type_combo)
        
        # ä»·æ ¼è¾“å…¥
        self.price_input = QDoubleSpinBox()
        self.price_input.setRange(0, 100000)
        self.price_input.setDecimals(2)
        self.price_input.setSingleStep(0.01)
        self.price_input.setPrefix("$")
        self.price_input.setEnabled(False)  # é»˜è®¤å¸‚ä»·ï¼Œç¦ç”¨
        form_layout.addRow("äº¤æ˜“ä»·æ ¼:", self.price_input)
        
        # æ•°é‡è¾“å…¥
        self.qty_input = QSpinBox()
        self.qty_input.setRange(1, 1000000)
        self.qty_input.setSingleStep(100)
        self.qty_input.setValue(100)
        self.qty_input.setSuffix(" è‚¡")
        form_layout.addRow("äº¤æ˜“æ•°é‡:", self.qty_input)
        
        # é¢„è®¡é‡‘é¢
        self.amount_label = QLabel("$0.00")
        self.amount_label.setStyleSheet("font-size: 14px; font-weight: bold;")
        form_layout.addRow("é¢„è®¡é‡‘é¢:", self.amount_label)
        
        form_group.setLayout(form_layout)
        layout.addWidget(form_group)
        
        # å®æ—¶ä¿¡æ¯
        info_group = QGroupBox("å®æ—¶è¡Œæƒ…")
        info_layout = QFormLayout()
        
        self.current_price_label = QLabel("--")
        self.bid_ask_label = QLabel("--/--")
        self.volume_label = QLabel("--")
        
        info_layout.addRow("å½“å‰ä»·:", self.current_price_label)
        info_layout.addRow("ä¹°ä¸€/å–ä¸€:", self.bid_ask_label)
        info_layout.addRow("æˆäº¤é‡:", self.volume_label)
        
        info_group.setLayout(info_layout)
        layout.addWidget(info_group)
        
        # æäº¤æŒ‰é’®
        button_layout = QHBoxLayout()
        
        self.buy_button = QPushButton("ğŸŸ¢ ä¹°å…¥")
        self.buy_button.setStyleSheet("""
            QPushButton {
                background-color: #28a745;
                color: white;
                font-size: 16px;
                padding: 10px;
                border-radius: 5px;
            }
            QPushButton:hover {
                background-color: #218838;
            }
        """)
        self.buy_button.clicked.connect(self.submit_buy_order)
        button_layout.addWidget(self.buy_button)
        
        self.sell_button = QPushButton("ğŸ”´ å–å‡º")
        self.sell_button.setStyleSheet("""
            QPushButton {
                background-color: #dc3545;
                color: white;
                font-size: 16px;
                padding: 10px;
                border-radius: 5px;
            }
            QPushButton:hover {
                background-color: #c82333;
            }
        """)
        self.sell_button.clicked.connect(self.submit_sell_order)
        button_layout.addWidget(self.sell_button)
        
        layout.addLayout(button_layout)
        
        # å¿«æ·æ“ä½œ
        quick_group = QGroupBox("å¿«æ·æ“ä½œ")
        quick_layout = QHBoxLayout()
        
        quick_buy_25 = QPushButton("ä¹°å…¥25%")
        quick_buy_50 = QPushButton("ä¹°å…¥50%")
        quick_buy_100 = QPushButton("ä¹°å…¥å…¨éƒ¨")
        
        quick_buy_25.clicked.connect(lambda: self.quick_buy(0.25))
        quick_buy_50.clicked.connect(lambda: self.quick_buy(0.50))
        quick_buy_100.clicked.connect(lambda: self.quick_buy(1.0))
        
        quick_layout.addWidget(quick_buy_25)
        quick_layout.addWidget(quick_buy_50)
        quick_layout.addWidget(quick_buy_100)
        
        quick_group.setLayout(quick_layout)
        layout.addWidget(quick_group)
        
        layout.addStretch()
    
    def on_price_type_changed(self, price_type):
        """ä»·æ ¼ç±»å‹æ”¹å˜"""
        if price_type == "é™ä»·":
            self.price_input.setEnabled(True)
        else:
            self.price_input.setEnabled(False)
    
    def submit_buy_order(self):
        """æäº¤ä¹°å…¥è®¢å•"""
        self._submit_order("BUY")
    
    def submit_sell_order(self):
        """æäº¤å–å‡ºè®¢å•"""
        self._submit_order("SELL")
    
    def _submit_order(self, direction):
        """æäº¤è®¢å•"""
        stock_code = self.stock_code_input.currentText().strip()
        if not stock_code:
            QMessageBox.warning(self, "é”™è¯¯", "è¯·è¾“å…¥è‚¡ç¥¨ä»£ç ")
            return
        
        price_type = self.price_type_combo.currentText()
        price = self.price_input.value() if price_type == "é™ä»·" else None
        qty = self.qty_input.value()
        
        # ç¡®è®¤å¯¹è¯æ¡†
        msg = f"ç¡®è®¤{direction}è®¢å•?\n"
        msg += f"è‚¡ç¥¨: {stock_code}\n"
        msg += f"æ–¹å‘: {direction}\n"
        msg += f"æ•°é‡: {qty}è‚¡\n"
        msg += f"ä»·æ ¼: {price_type}"
        if price:
            msg += f" ${price:.2f}"
        
        reply = QMessageBox.question(self, "ç¡®è®¤è®¢å•", msg,
                                     QMessageBox.StandardButton.Yes | 
                                     QMessageBox.StandardButton.No)
        
        if reply == QMessageBox.StandardButton.Yes:
            order = {
                'stock_code': stock_code,
                'direction': direction,
                'price_type': price_type,
                'price': price,
                'qty': qty
            }
            
            self.order_submitted.emit(order)
    
    def quick_buy(self, ratio):
        """å¿«æ·ä¹°å…¥ï¼ˆæŒ‰å¯ç”¨èµ„é‡‘æ¯”ä¾‹ï¼‰"""
        # TODO: æ ¹æ®å¯ç”¨èµ„é‡‘è‡ªåŠ¨è®¡ç®—æ•°é‡
        pass
    
    def update_quote(self, stock_code, quote):
        """
        æ›´æ–°å®æ—¶è¡Œæƒ…
        
        Parameters:
        -----------
        quote : dict
            {
                'price': 442.50,
                'bid': 442.45,
                'ask': 442.55,
                'volume': 1250000
            }
        """
        if self.stock_code_input.currentText() == stock_code:
            self.current_price_label.setText(f"${quote['price']:.2f}")
            self.bid_ask_label.setText(f"${quote['bid']:.2f} / ${quote['ask']:.2f}")
            self.volume_label.setText(f"{quote['volume']:,}")
            
            # æ›´æ–°é¢„è®¡é‡‘é¢
            self.price_input.setValue(quote['price'])
            amount = quote['price'] * self.qty_input.value()
            self.amount_label.setText(f"${amount:,.2f}")
```

---

## ğŸ“ **3. è®¢å•ç®¡ç†é¢æ¿ (Order Widget)**

```python
"""
è®¢å•ç®¡ç†é¢æ¿
ui/widgets/order_widget.py
"""
from PyQt6.QtWidgets import (QWidget, QVBoxLayout, QHBoxLayout,
                             QTableWidget, QLabel, QPushButton,
                             QTabWidget, QTableWidgetItem, QHeaderView,
                             QComboBox, QDateEdit)
from PyQt6.QtCore import Qt, pyqtSignal, QDate


class OrderWidget(QWidget):
    """è®¢å•ç®¡ç†é¢æ¿"""
    
    # ä¿¡å·
    cancel_order = pyqtSignal(str)  # æ’¤å•ä¿¡å·ï¼ˆè®¢å•IDï¼‰
    
    def __init__(self):
        super().__init__()
        self.init_ui()
    
    def init_ui(self):
        """åˆå§‹åŒ–UI"""
        layout = QVBoxLayout(self)
        
        # æ ‡é¢˜å’Œç­›é€‰
        header_layout = QHBoxLayout()
        
        title = QLabel("ğŸ“ è®¢å•ç®¡ç†")
        title.setStyleSheet("font-size: 16px; font-weight: bold;")
        header_layout.addWidget(title)
        
        # æ—¥æœŸç­›é€‰
        header_layout.addWidget(QLabel("æ—¥æœŸ:"))
        self.date_from = QDateEdit()
        self.date_from.setDate(QDate.currentDate().addDays(-7))
        self.date_from.setCalendarPopup(True)
        header_layout.addWidget(self.date_from)
        
        header_layout.addWidget(QLabel("-"))
        
        self.date_to = QDateEdit()
        self.date_to.setDate(QDate.currentDate())
        self.date_to.setCalendarPopup(True)
        header_layout.addWidget(self.date_to)
        
        # çŠ¶æ€ç­›é€‰
        header_layout.addWidget(QLabel("çŠ¶æ€:"))
        self.status_filter = QComboBox()
        self.status_filter.addItems(["å…¨éƒ¨", "å¾…æˆäº¤", "éƒ¨åˆ†æˆäº¤", "å·²æˆäº¤", "å·²æ’¤é”€"])
        header_layout.addWidget(self.status_filter)
        
        refresh_btn = QPushButton("ğŸ”„ åˆ·æ–°")
        refresh_btn.clicked.connect(self.refresh_orders)
        header_layout.addWidget(refresh_btn)
        
        header_layout.addStretch()
        layout.addLayout(header_layout)
        
        # æ ‡ç­¾é¡µ
        self.tabs = QTabWidget()
        
        # ä»Šæ—¥å§”æ‰˜
        self.today_table = self._create_order_table()
        self.tabs.addTab(self.today_table, "ä»Šæ—¥å§”æ‰˜")
        
        # å†å²å§”æ‰˜
        self.history_table = self._create_order_table()
        self.tabs.addTab(self.history_table, "å†å²å§”æ‰˜")
        
        # æˆäº¤è®°å½•
        self.trade_table = self._create_trade_table()
        self.tabs.addTab(self.trade_table, "æˆäº¤è®°å½•")
        
        layout.addWidget(self.tabs)
        
        # åº•éƒ¨æŒ‰é’®
        button_layout = QHBoxLayout()
        
        export_btn = QPushButton("ğŸ“¤ å¯¼å‡ºè®¢å•")
        export_btn.clicked.connect(self.export_orders)
        button_layout.addWidget(export_btn)
        
        cancel_all_btn = QPushButton("ğŸš« æ’¤é”€å…¨éƒ¨å¾…æˆäº¤")
        cancel_all_btn.setStyleSheet("color: orange;")
        cancel_all_btn.clicked.connect(self.cancel_all_pending)
        button_layout.addWidget(cancel_all_btn)
        
        button_layout.addStretch()
        layout.addLayout(button_layout)
    
    def _create_order_table(self):
        """åˆ›å»ºè®¢å•è¡¨æ ¼"""
        table = QTableWidget()
        table.setColumnCount(11)
        table.setHorizontalHeaderLabels([
            'è®¢å•å·', 'æ—¶é—´', 'è‚¡ç¥¨ä»£ç ', 'è‚¡ç¥¨åç§°', 'æ–¹å‘', 
            'ä»·æ ¼ç±»å‹', 'å§”æ‰˜ä»·', 'å§”æ‰˜é‡', 'æˆäº¤é‡', 'çŠ¶æ€', 'æ“ä½œ'
        ])
        
        header = table.horizontalHeader()
        header.setSectionResizeMode(QHeaderView.ResizeMode.Stretch)
        
        return table
    
    def _create_trade_table(self):
        """åˆ›å»ºæˆäº¤è®°å½•è¡¨æ ¼"""
        table = QTableWidget()
        table.setColumnCount(9)
        table.setHorizontalHeaderLabels([
            'æˆäº¤æ—¶é—´', 'è‚¡ç¥¨ä»£ç ', 'è‚¡ç¥¨åç§°', 'æ–¹å‘', 
            'æˆäº¤ä»·', 'æˆäº¤é‡', 'æˆäº¤é¢', 'æ‰‹ç»­è´¹', 'è®¢å•å·'
        ])
        
        header = table.horizontalHeader()
        header.setSectionResizeMode(QHeaderView.ResizeMode.Stretch)
        
        return table
    
    def update_orders(self, orders):
        """
        æ›´æ–°è®¢å•åˆ—è¡¨
        
        Parameters:
        -----------
        orders : list
            è®¢å•åˆ—è¡¨
            [{
                'order_id': '123456',
                'time': '2025-01-22 10:30:00',
                'code': 'TSLA',
                'name': 'ç‰¹æ–¯æ‹‰',
                'direction': 'BUY',
                'price_type': 'é™ä»·',
                'price': 442.50,
                'qty': 100,
                'filled_qty': 0,
                'status': 'å¾…æˆäº¤'
            }, ...]
        """
        self.today_table.setRowCount(0)
        
        for order in orders:
            row = self.today_table.rowCount()
            self.today_table.insertRow(row)
            
            # è®¢å•å·
            self.today_table.setItem(row, 0, QTableWidgetItem(order['order_id']))
            
            # æ—¶é—´
            self.today_table.setItem(row, 1, QTableWidgetItem(order['time']))
            
            # è‚¡ç¥¨ä»£ç 
            self.today_table.setItem(row, 2, QTableWidgetItem(order['code']))
            
            # è‚¡ç¥¨åç§°
            self.today_table.setItem(row, 3, QTableWidgetItem(order['name']))
            
            # æ–¹å‘
            direction_item = QTableWidgetItem(order['direction'])
            direction_item.setForeground(QColor('green' if order['direction'] == 'BUY' else 'red'))
            self.today_table.setItem(row, 4, direction_item)
            
            # ä»·æ ¼ç±»å‹
            self.today_table.setItem(row, 5, QTableWidgetItem(order['price_type']))
            
            # å§”æ‰˜ä»·
            self.today_table.setItem(row, 6, QTableWidgetItem(f"${order['price']:.2f}"))
            
            # å§”æ‰˜é‡
            self.today_table.setItem(row, 7, QTableWidgetItem(str(order['qty'])))
            
            # æˆäº¤é‡
            self.today_table.setItem(row, 8, QTableWidgetItem(str(order['filled_qty'])))
            
            # çŠ¶æ€
            status_item = QTableWidgetItem(order['status'])
            if order['status'] == 'å·²æˆäº¤':
                status_item.setForeground(QColor('green'))
            elif order['status'] == 'å·²æ’¤é”€':
                status_item.setForeground(QColor('gray'))
            self.today_table.setItem(row, 9, status_item)
            
            # æ“ä½œæŒ‰é’®
            if order['status'] in ['å¾…æˆäº¤', 'éƒ¨åˆ†æˆäº¤']:
                button_widget = QWidget()
                button_layout = QHBoxLayout(button_widget)
                button_layout.setContentsMargins(2, 2, 2, 2)
                
                cancel_btn = QPushButton("æ’¤å•")
                cancel_btn.clicked.connect(
                    lambda checked, order_id=order['order_id']: 
                    self.cancel_order.emit(order_id)
                )
                button_layout.addWidget(cancel_btn)
                
                self.today_table.setCellWidget(row, 10, button_widget)
    
    def refresh_orders(self):
        """åˆ·æ–°è®¢å•"""
        # TODO: ä»äº¤æ˜“å¼•æ“è·å–æœ€æ–°è®¢å•
        pass
    
    def export_orders(self):
        """å¯¼å‡ºè®¢å•"""
        # TODO: å¯¼å‡ºä¸ºCSV
        pass
    
    def cancel_all_pending(self):
        """æ’¤é”€æ‰€æœ‰å¾…æˆäº¤è®¢å•"""
        # TODO: æ‰¹é‡æ’¤å•
        pass
```

---

## ğŸ¤– **4. è‡ªåŠ¨äº¤æ˜“æ§åˆ¶é¢æ¿ (Auto Trade Widget)**

```python
"""
è‡ªåŠ¨äº¤æ˜“æ§åˆ¶é¢æ¿
ui/widgets/auto_trade_widget.py
"""
from PyQt6.QtWidgets import (QWidget, QVBoxLayout, QHBoxLayout,
                             QLabel, QPushButton, QTableWidget,
                             QGroupBox, QCheckBox, QSpinBox,
                             QDoubleSpinBox, QTextEdit, QFormLayout,
                             QTableWidgetItem, QHeaderView)
from PyQt6.QtCore import Qt, pyqtSignal


class AutoTradeWidget(QWidget):
    """è‡ªåŠ¨äº¤æ˜“æ§åˆ¶é¢æ¿"""
    
    # ä¿¡å·
    auto_trade_toggled = pyqtSignal(bool)  # è‡ªåŠ¨äº¤æ˜“å¼€å…³
    
    def __init__(self):
        super().__init__()
        self.init_ui()
    
    def init_ui(self):
        """åˆå§‹åŒ–UI"""
        layout = QVBoxLayout(self)
        
        # æ ‡é¢˜
        title = QLabel("ğŸ¤– è‡ªåŠ¨äº¤æ˜“ç³»ç»Ÿ")
        title.setStyleSheet("font-size: 16px; font-weight: bold;")
        layout.addWidget(title)
        
        # çŠ¶æ€æ˜¾ç¤º
        status_group = QGroupBox("ç³»ç»ŸçŠ¶æ€")
        status_layout = QVBoxLayout()
        
        # çŠ¶æ€æŒ‡ç¤º
        status_row = QHBoxLayout()
        self.status_label = QLabel("âšª è‡ªåŠ¨äº¤æ˜“å·²å…³é—­")
        self.status_label.setStyleSheet("font-size: 14px; font-weight: bold;")
        status_row.addWidget(self.status_label)
        
        self.toggle_btn = QPushButton("å¯åŠ¨è‡ªåŠ¨äº¤æ˜“")
        self.toggle_btn.setStyleSheet("""
            QPushButton {
                background-color: #28a745;
                color: white;
                padding: 10px 20px;
                border-radius: 5px;
            }
        """)
        self.toggle_btn.clicked.connect(self.toggle_auto_trade)
        status_row.addWidget(self.toggle_btn)
        status_row.addStretch()
        
        status_layout.addLayout(status_row)
        
        # ç»Ÿè®¡ä¿¡æ¯
        stats_layout = QHBoxLayout()
        self.today_signals_label = QLabel("ä»Šæ—¥ä¿¡å·: 0")
        self.today_trades_label = QLabel("ä»Šæ—¥äº¤æ˜“: 0")
        self.success_rate_label = QLabel("æˆåŠŸç‡: 0%")
        
        stats_layout.addWidget(self.today_signals_label)
        stats_layout.addWidget(self.today_trades_label)
        stats_layout.addWidget(self.success_rate_label)
        stats_layout.addStretch()
        
        status_layout.addLayout(stats_layout)
        
        status_group.setLayout(status_layout)
        layout.addWidget(status_group)
        
        # é£æ§è®¾ç½®
        risk_group = QGroupBox("é£æ§è®¾ç½®")
        risk_layout = QFormLayout()
        
        # å•ç¬”æœ€å¤§é‡‘é¢
        self.max_amount_input = QDoubleSpinBox()
        self.max_amount_input.setRange(0, 1000000)
        self.max_amount_input.setValue(10000)
        self.max_amount_input.setPrefix("$")
        risk_layout.addRow("å•ç¬”æœ€å¤§é‡‘é¢:", self.max_amount_input)
        
        # å•æ—¥æœ€å¤§äº¤æ˜“æ¬¡æ•°
        self.max_trades_input = QSpinBox()
        self.max_trades_input.setRange(1, 100)
        self.max_trades_input.setValue(10)
        risk_layout.addRow("å•æ—¥æœ€å¤§äº¤æ˜“æ¬¡æ•°:", self.max_trades_input)
        
        # æ­¢æŸæ¯”ä¾‹
        self.stop_loss_input = QDoubleSpinBox()
        self.stop_loss_input.setRange(0, 100)
        self.stop_loss_input.setValue(5.0)
        self.stop_loss_input.setSuffix("%")
        risk_layout.addRow("æ­¢æŸæ¯”ä¾‹:", self.stop_loss_input)
        
        # æ­¢ç›ˆæ¯”ä¾‹
        self.take_profit_input = QDoubleSpinBox()
        self.take_profit_input.setRange(0, 100)
        self.take_profit_input.setValue(10.0)
        self.take_profit_input.setSuffix("%")
        risk_layout.addRow("æ­¢ç›ˆæ¯”ä¾‹:", self.take_profit_input)
        
        # å¯ç”¨AIç¡®è®¤
        self.ai_confirm_checkbox = QCheckBox("å¯ç”¨AIä¿¡å·ç¡®è®¤")
        self.ai_confirm_checkbox.setChecked(True)
        risk_layout.addRow("", self.ai_confirm_checkbox)
        
        risk_group.setLayout(risk_layout)
        layout.addWidget(risk_group)
        
        # å¾…æ‰§è¡Œä¿¡å·
        signals_group = QGroupBox("å¾…æ‰§è¡Œä¿¡å·")
        signals_layout = QVBoxLayout()
        
        self.signals_table = QTableWidget()
        self.signals_table.setColumnCount(7)
        self.signals_table.setHorizontalHeaderLabels([
            'è‚¡ç¥¨ä»£ç ', 'ä¿¡å·ç±»å‹', 'ç”Ÿæˆæ—¶é—´', 'å½“å‰ä»·', 
            'å»ºè®®ä»·', 'AIè¯„åˆ†', 'æ“ä½œ'
        ])
        
        header = self.signals_table.horizontalHeader()
        header.setSectionResizeMode(QHeaderView.ResizeMode.Stretch)
        
        signals_layout.addWidget(self.signals_table)
        signals_group.setLayout(signals_layout)
        layout.addWidget(signals_group)
        
        # æ‰§è¡Œæ—¥å¿—
        log_group = QGroupBox("æ‰§è¡Œæ—¥å¿—")
        log_layout = QVBoxLayout()
        
        self.log_text = QTextEdit()
        self.log_text.setReadOnly(True)
        self.log_text.setMaximumHeight(200)
        log_layout.addWidget(self.log_text)
        
        clear_log_btn = QPushButton("æ¸…ç©ºæ—¥å¿—")
        clear_log_btn.clicked.connect(self.log_text.clear)
        log_layout.addWidget(clear_log_btn)
        
        log_group.setLayout(log_layout)
        layout.addWidget(log_group)
    
    def toggle_auto_trade(self):
        """åˆ‡æ¢è‡ªåŠ¨äº¤æ˜“çŠ¶æ€"""
        current_state = self.status_label.text()
        
        if "å·²å…³é—­" in current_state:
            # å¯åŠ¨
            self.status_label.setText("ğŸŸ¢ è‡ªåŠ¨äº¤æ˜“è¿è¡Œä¸­")
            self.status_label.setStyleSheet(
                "font-size: 14px; font-weight: bold; color: green;"
            )
            self.toggle_btn.setText("åœæ­¢è‡ªåŠ¨äº¤æ˜“")
            self.toggle_btn.setStyleSheet("""
                QPushButton {
                    background-color: #dc3545;
                    color: white;
                    padding: 10px 20px;
                    border-radius: 5px;
                }
            """)
            self.auto_trade_toggled.emit(True)
            self.add_log("âœ… è‡ªåŠ¨äº¤æ˜“å·²å¯åŠ¨")
        else:
            # åœæ­¢
            self.status_label.setText("âšª è‡ªåŠ¨äº¤æ˜“å·²å…³é—­")
            self.status_label.setStyleSheet(
                "font-size: 14px; font-weight: bold; color: gray;"
            )
            self.toggle_btn.setText("å¯åŠ¨è‡ªåŠ¨äº¤æ˜“")
            self.toggle_btn.setStyleSheet("""
                QPushButton {
                    background-color: #28a745;
                    color: white;
                    padding: 10px 20px;
                    border-radius: 5px;
                }
            """)
            self.auto_trade_toggled.emit(False)
            self.add_log("âš ï¸  è‡ªåŠ¨äº¤æ˜“å·²åœæ­¢")
    
    def add_log(self, message):
        """æ·»åŠ æ—¥å¿—"""
        from datetime import datetime
        timestamp = datetime.now().strftime('%Y-%m-%d %H:%M:%S')
        self.log_text.append(f"[{timestamp}] {message}")
    
    def update_pending_signals(self, signals):
        """
        æ›´æ–°å¾…æ‰§è¡Œä¿¡å·
        
        Parameters:
        -----------
        signals : list
            [{
                'code': 'TSLA',
                'type': 'BUY',
                'time': '2025-01-22 16:10:00',
                'current_price': 442.50,
                'suggest_price': '440-445',
                'ai_score': 85
            }, ...]
        """
        self.signals_table.setRowCount(0)
        
        for signal in signals:
            row = self.signals_table.rowCount()
            self.signals_table.insertRow(row)
            
            self.signals_table.setItem(row, 0, QTableWidgetItem(signal['code']))
            
            type_item = QTableWidgetItem(signal['type'])
            type_item.setForeground(QColor('green' if signal['type'] == 'BUY' else 'red'))
            self.signals_table.setItem(row, 1, type_item)
            
            self.signals_table.setItem(row, 2, QTableWidgetItem(signal['time']))
            self.signals_table.setItem(row, 3, QTableWidgetItem(f"${signal['current_price']:.2f}"))
            self.signals_table.setItem(row, 4, QTableWidgetItem(signal['suggest_price']))
            self.signals_table.setItem(row, 5, QTableWidgetItem(str(signal['ai_score'])))
            
            # æ“ä½œæŒ‰é’®
            button_widget = QWidget()
            button_layout = QHBoxLayout(button_widget)
            button_layout.setContentsMargins(2, 2, 2, 2)
            
            execute_btn = QPushButton("ç«‹å³æ‰§è¡Œ")
            execute_btn.clicked.connect(
                lambda checked, sig=signal: self.execute_signal(sig)
            )
            button_layout.addWidget(execute_btn)
            
            ignore_btn = QPushButton("å¿½ç•¥")
            ignore_btn.clicked.connect(
                lambda checked, sig=signal: self.ignore_signal(sig)
            )
            button_layout.addWidget(ignore_btn)
            
            self.signals_table.setCellWidget(row, 6, button_widget)
    
    def execute_signal(self, signal):
        """æ‰§è¡Œä¿¡å·"""
        self.add_log(f"ğŸ“ æ‰§è¡Œä¿¡å·: {signal['code']} {signal['type']}")
        # TODO: è°ƒç”¨äº¤æ˜“å¼•æ“æ‰§è¡Œ
    
    def ignore_signal(self, signal):
        """å¿½ç•¥ä¿¡å·"""
        self.add_log(f"âš ï¸  å¿½ç•¥ä¿¡å·: {signal['code']} {signal['type']}")
```

---

## ğŸ“Š **5. è´¦æˆ·ä¿¡æ¯é¢æ¿ (Account Widget)**

```python
"""
è´¦æˆ·ä¿¡æ¯é¢æ¿
ui/widgets/account_widget.py
"""
from PyQt6.QtWidgets import (QWidget, QVBoxLayout, QHBoxLayout,
                             QLabel, QGroupBox, QFormLayout)
from PyQt6.QtCore import Qt
from PyQt6.QtCharts import QChart, QChartView, QPieSeries, QLineSeries
from PyQt6.QtGui import QPainter, QColor


class AccountWidget(QWidget):
    """è´¦æˆ·ä¿¡æ¯é¢æ¿"""
    
    def __init__(self):
        super().__init__()
        self.init_ui()
    
    def init_ui(self):
        """åˆå§‹åŒ–UI"""
        layout = QVBoxLayout(self)
        
        # æ ‡é¢˜
        title = QLabel("ğŸ’° è´¦æˆ·ä¿¡æ¯")
        title.setStyleSheet("font-size: 16px; font-weight: bold;")
        layout.addWidget(title)
        
        # è´¦æˆ·æ€»è§ˆ
        overview_group = QGroupBox("è´¦æˆ·æ€»è§ˆ")
        overview_layout = QFormLayout()
        
        self.total_asset_label = QLabel("$0.00")
        self.total_asset_label.setStyleSheet("font-size: 20px; font-weight: bold;")
        overview_layout.addRow("æ€»èµ„äº§:", self.total_asset_label)
        
        self.available_label = QLabel("$0.00")
        overview_layout.addRow("å¯ç”¨èµ„é‡‘:", self.available_label)
        
        self.frozen_label = QLabel("$0.00")
        overview_layout.addRow("å†»ç»“èµ„é‡‘:", self.frozen_label)
        
        self.market_value_label = QLabel("$0.00")
        overview_layout.addRow("æŒä»“å¸‚å€¼:", self.market_value_label)
        
        self.profit_label = QLabel("$0.00 (0.00%)")
        self.profit_label.setStyleSheet("color: green; font-weight: bold;")
        overview_layout.addRow("æµ®åŠ¨ç›ˆäº:", self.profit_label)
        
        overview_group.setLayout(overview_layout)
        layout.addWidget(overview_group)
        
        # èµ„äº§åˆ†å¸ƒé¥¼å›¾
        allocation_group = QGroupBox("èµ„äº§åˆ†å¸ƒ")
        allocation_layout = QVBoxLayout()
        
        self.pie_chart = self._create_pie_chart()
        self.pie_chart_view = QChartView(self.pie_chart)
        self.pie_chart_view.setRenderHint(QPainter.RenderHint.Antialiasing)
        self.pie_chart_view.setMaximumHeight(250)
        
        allocation_layout.addWidget(self.pie_chart_view)
        allocation_group.setLayout(allocation_layout)
        layout.addWidget(allocation_group)
        
        # ä»Šæ—¥ç»Ÿè®¡
        today_group = QGroupBox("ä»Šæ—¥ç»Ÿè®¡")
        today_layout = QFormLayout()
        
        self.today_profit_label = QLabel("$0.00")
        today_layout.addRow("ä»Šæ—¥ç›ˆäº:", self.today_profit_label)
        
        self.today_trades_label = QLabel("0ç¬”")
        today_layout.addRow("äº¤æ˜“æ¬¡æ•°:", self.today_trades_label)
        
        self.today_turnover_label = QLabel("$0.00")
        today_layout.addRow("æˆäº¤é‡‘é¢:", self.today_turnover_label)
        
        self.today_commission_label = QLabel("$0.00")
        today_layout.addRow("æ‰‹ç»­è´¹:", self.today_commission_label)
        
        today_group.setLayout(today_layout)
        layout.addWidget(today_group)
        
        layout.addStretch()
    
    def _create_pie_chart(self):
        """åˆ›å»ºé¥¼å›¾"""
        series = QPieSeries()
        series.append("ç°é‡‘", 50)
        series.append("è‚¡ç¥¨", 50)
        
        chart = QChart()
        chart.addSeries(series)
        chart.setTitle("èµ„äº§åˆ†å¸ƒ")
        chart.legend().setVisible(True)
        chart.legend().setAlignment(Qt.AlignmentFlag.AlignBottom)
        
        return chart
    
    def update_account(self, account_info):
        """
        æ›´æ–°è´¦æˆ·ä¿¡æ¯
        
        Parameters:
        -----------
        account_info : dict
            {
                'total_asset': 150000.00,
                'available': 48000.00,
                'frozen': 0.00,
                'market_value': 102000.00,
                'profit': 2000.00,
                'profit_rate': 1.35,
                'today_profit': 500.00,
                'today_trades': 3,
                'today_turnover': 50000.00,
                'today_commission': 50.00
            }
        """
        # æ›´æ–°è´¦æˆ·æ€»è§ˆ
        self.total_asset_label.setText(f"${account_info['total_asset']:,.2f}")
        self.available_label.setText(f"${account_info['available']:,.2f}")
        self.frozen_label.setText(f"${account_info['frozen']:,.2f}")
        self.market_value_label.setText(f"${account_info['market_value']:,.2f}")
        
        profit_text = f"${account_info['profit']:+,.2f} ({account_info['profit_rate']:+.2f}%)"
        self.profit_label.setText(profit_text)
        self.profit_label.setStyleSheet(
            f"color: {'green' if account_info['profit'] > 0 else 'red'}; font-weight: bold;"
        )
        
        # æ›´æ–°ä»Šæ—¥ç»Ÿè®¡
        self.today_profit_label.setText(f"${account_info['today_profit']:+,.2f}")
        self.today_profit_label.setStyleSheet(
            f"color: {'green' if account_info['today_profit'] > 0 else 'red'};"
        )
        self.today_trades_label.setText(f"{account_info['today_trades']}ç¬”")
        self.today_turnover_label.setText(f"${account_info['today_turnover']:,.2f}")
        self.today_commission_label.setText(f"${account_info['today_commission']:,.2f}")
        
        # æ›´æ–°é¥¼å›¾
        self._update_pie_chart(account_info['available'], account_info['market_value'])
    
    def _update_pie_chart(self, cash, stock):
        """æ›´æ–°é¥¼å›¾"""
        series = QPieSeries()
        series.append(f"ç°é‡‘ ${cash:,.0f}", cash)
        series.append(f"è‚¡ç¥¨ ${stock:,.0f}", stock)
        
        # è®¾ç½®é¢œè‰²
        series.slices()[0].setColor(QColor("#28a745"))
        series.slices()[1].setColor(QColor("#007bff"))
        
        self.pie_chart.removeAllSeries()
        self.pie_chart.addSeries(series)
```

---

## ğŸ“ˆ **6. é›†æˆåˆ°ä¸»çª—å£**

```python
"""
ä¸»çª—å£é›†æˆç¤ºä¾‹
ui/main_window.py (è¡¥å……äº¤æ˜“ç›¸å…³éƒ¨åˆ†)
"""

class MainWindow(QMainWindow):
    def __init__(self):
        super().__init__()
        
        # ... å…¶ä»–åˆå§‹åŒ– ...
        
        # åˆ›å»ºå³ä¾§é¢æ¿æ ‡ç­¾é¡µ
        self.right_tabs = QTabWidget()
        
        # æŒä»“é¢æ¿
        self.position_widget = PositionWidget()
        self.position_widget.close_position.connect(self.on_close_position)
        self.position_widget.add_position.connect(self.on_add_position)
        self.right_tabs.addTab(self.position_widget, "ğŸ“Š æŒä»“")
        
        # è®¢å•é¢æ¿
        self.order_widget = OrderWidget()
        self.order_widget.cancel_order.connect(self.on_cancel_order)
        self.right_tabs.addTab(self.order_widget, "ğŸ“ è®¢å•")
        
        # è´¦æˆ·é¢æ¿
        self.account_widget = AccountWidget()
        self.right_tabs.addTab(self.account_widget, "ğŸ’° è´¦æˆ·")
        
        # ä¸­é—´é¢æ¿æ ‡ç­¾é¡µ
        self.center_tabs = QTabWidget()
        
        # ä¿¡å·é¢æ¿ï¼ˆå·²æœ‰ï¼‰
        # ... 
        
        # äº¤æ˜“é¢æ¿
        self.trade_widget = TradeWidget()
        self.trade_widget.order_submitted.connect(self.on_order_submitted)
        self.center_tabs.addTab(self.trade_widget, "ğŸ”„ äº¤æ˜“")
        
        # è‡ªåŠ¨äº¤æ˜“é¢æ¿
        self.auto_trade_widget = AutoTradeWidget()
        self.auto_trade_widget.auto_trade_toggled.connect(self.on_auto_trade_toggled)
        self.center_tabs.addTab(self.auto_trade_widget, "ğŸ¤– è‡ªåŠ¨äº¤æ˜“")
    
    def on_close_position(self, stock_code, qty):
        """å¹³ä»“"""
        print(f"å¹³ä»“: {stock_code} {qty}è‚¡")
        # TODO: è°ƒç”¨äº¤æ˜“å¼•æ“
    
    def on_add_position(self, stock_code):
        """åŠ ä»“"""
        print(f"åŠ ä»“: {stock_code}")
        # TODO: åˆ‡æ¢åˆ°äº¤æ˜“é¢æ¿å¹¶é¢„å¡«è‚¡ç¥¨ä»£ç 
    
    def on_cancel_order(self, order_id):
        """æ’¤å•"""
        print(f"æ’¤å•: {order_id}")
        # TODO: è°ƒç”¨äº¤æ˜“å¼•æ“
    
    def on_order_submitted(self, order):
        """æäº¤è®¢å•"""
        print(f"æäº¤è®¢å•: {order}")
        # TODO: è°ƒç”¨äº¤æ˜“å¼•æ“
    
    def on_auto_trade_toggled(self, enabled):
        """è‡ªåŠ¨äº¤æ˜“å¼€å…³"""
        print(f"è‡ªåŠ¨äº¤æ˜“: {'å¯åŠ¨' if enabled else 'åœæ­¢'}")
        # TODO: å¯åŠ¨/åœæ­¢è‡ªåŠ¨äº¤æ˜“
```

---

## ğŸ¨ **7. æ ·å¼è¡¨ (Stylesheet)**

```python
"""
äº¤æ˜“ç›¸å…³ç»„ä»¶æ ·å¼
resources/styles/trade_style.qss
"""

/* æŒä»“ç›ˆåˆ© */
.profit-positive {
    color: #28a745;
    font-weight: bold;
}

/* æŒä»“äºæŸ */
.profit-negative {
    color: #dc3545;
    font-weight: bold;
}

/* ä¹°å…¥æŒ‰é’® */
QPushButton#buy-button {
    background-color: #28a745;
    color: white;
    font-size: 16px;
    padding: 10px;
    border-radius: 5px;
    border: none;
}

QPushButton#buy-button:hover {
    background-color: #218838;
}

QPushButton#buy-button:pressed {
    background-color: #1e7e34;
}

/* å–å‡ºæŒ‰é’® */
QPushButton#sell-button {
    background-color: #dc3545;
    color: white;
    font-size: 16px;
    padding: 10px;
    border-radius: 5px;
    border: none;
}

QPushButton#sell-button:hover {
    background-color: #c82333;
}

QPushButton#sell-button:pressed {
    background-color: #bd2130;
}

/* è‡ªåŠ¨äº¤æ˜“çŠ¶æ€ - è¿è¡Œä¸­ */
.auto-trade-active {
    color: #28a745;
    font-weight: bold;
    font-size: 14px;
}

/* è‡ªåŠ¨äº¤æ˜“çŠ¶æ€ - å·²åœæ­¢ */
.auto-trade-inactive {
    color: #6c757d;
    font-weight: bold;
    font-size: 14px;
}

/* è®¢å•è¡¨æ ¼ */
QTableWidget#order-table {
    gridline-color: #dee2e6;
    selection-background-color: #007bff;
}

QTableWidget#order-table::item:selected {
    background-color: #007bff;
    color: white;
}

/* æŒä»“è¡¨æ ¼ */
QTableWidget#position-table {
    gridline-color: #dee2e6;
    selection-background-color: #007bff;
}

QTableWidget#position-table::item:selected {
    background-color: #007bff;
    color: white;
}
```

---

## ğŸ“Š **8. æ•°æ®æ¨¡å‹**

```python
"""
äº¤æ˜“æ•°æ®æ¨¡å‹
models/trade_models.py
"""
from dataclasses import dataclass
from datetime import datetime
from typing import Optional


@dataclass
class Position:
    """æŒä»“"""
    code: str               # è‚¡ç¥¨ä»£ç 
    name: str               # è‚¡ç¥¨åç§°
    qty: int                # æŒä»“æ•°é‡
    available_qty: int      # å¯ç”¨æ•°é‡
    cost_price: float       # æˆæœ¬ä»·
    current_price: float    # ç°ä»·
    market_value: float     # å¸‚å€¼
    profit: float           # ç›ˆäºé‡‘é¢
    profit_rate: float      # ç›ˆäºæ¯”ä¾‹


@dataclass
class Order:
    """è®¢å•"""
    order_id: str                   # è®¢å•å·
    time: datetime                  # æ—¶é—´
    code: str                       # è‚¡ç¥¨ä»£ç 
    name: str                       # è‚¡ç¥¨åç§°
    direction: str                  # æ–¹å‘: BUY/SELL
    price_type: str                 # ä»·æ ¼ç±»å‹
    price: float                    # å§”æ‰˜ä»·
    qty: int                        # å§”æ‰˜é‡
    filled_qty: int                 # æˆäº¤é‡
    status: str                     # çŠ¶æ€
    avg_price: Optional[float] = None  # æˆäº¤å‡ä»·


@dataclass
class Trade:
    """æˆäº¤è®°å½•"""
    trade_id: str          # æˆäº¤å·
    time: datetime         # æˆäº¤æ—¶é—´
    order_id: str          # è®¢å•å·
    code: str              # è‚¡ç¥¨ä»£ç 
    name: str              # è‚¡ç¥¨åç§°
    direction: str         # æ–¹å‘
    price: float           # æˆäº¤ä»·
    qty: int               # æˆäº¤é‡
    amount: float          # æˆäº¤é¢
    commission: float      # æ‰‹ç»­è´¹


@dataclass
class Account:
    """è´¦æˆ·ä¿¡æ¯"""
    total_asset: float      # æ€»èµ„äº§
    available: float        # å¯ç”¨èµ„é‡‘
    frozen: float           # å†»ç»“èµ„é‡‘
    market_value: float     # æŒä»“å¸‚å€¼
    profit: float           # æµ®åŠ¨ç›ˆäº
    profit_rate: float      # ç›ˆäºæ¯”ä¾‹
    today_profit: float     # ä»Šæ—¥ç›ˆäº
    today_trades: int       # ä»Šæ—¥äº¤æ˜“æ¬¡æ•°
    today_turnover: float   # ä»Šæ—¥æˆäº¤é¢
    today_commission: float # ä»Šæ—¥æ‰‹ç»­è´¹
```

---

## âœ… **å®Œæ•´åŠŸèƒ½æ¸…å•**

### **æŒä»“ç®¡ç†** âœ…
- [x] æŒä»“åˆ—è¡¨å±•ç¤º
- [x] å®æ—¶ç›ˆäºè®¡ç®—
- [x] æŒä»“ç»Ÿè®¡æ±‡æ€»
- [x] å¹³ä»“/åŠ ä»“æ“ä½œ
- [x] æŒä»“å¯¼å‡º

### **äº¤æ˜“æ‰§è¡Œ** âœ…
- [x] å¿«é€Ÿä¸‹å•ç•Œé¢
- [x] å¸‚ä»·/é™ä»·ä¸‹å•
- [x] å®æ—¶è¡Œæƒ…æ˜¾ç¤º
- [x] å¿«æ·æ“ä½œæŒ‰é’®
- [x] è®¢å•ç¡®è®¤å¯¹è¯æ¡†

### **è®¢å•ç®¡ç†** âœ…
- [x] ä»Šæ—¥å§”æ‰˜æŸ¥è¯¢
- [x] å†å²å§”æ‰˜æŸ¥è¯¢
- [x] æˆäº¤è®°å½•æŸ¥è¯¢
- [x] è®¢å•æ’¤é”€
- [x] æ‰¹é‡æ’¤å•

### **è‡ªåŠ¨äº¤æ˜“** âœ…
- [x] è‡ªåŠ¨äº¤æ˜“å¼€å…³
- [x] é£æ§å‚æ•°è®¾ç½®
- [x] AIä¿¡å·ç¡®è®¤
- [x] å¾…æ‰§è¡Œä¿¡å·åˆ—è¡¨
- [x] æ‰§è¡Œæ—¥å¿—è®°å½•

### **è´¦æˆ·ä¿¡æ¯** âœ…
- [x] è´¦æˆ·æ€»è§ˆ
- [x] èµ„äº§åˆ†å¸ƒé¥¼å›¾
- [x] ä»Šæ—¥ç»Ÿè®¡
- [x] å®æ—¶æ›´æ–°

---

## ğŸš€ **ä¸‹ä¸€æ­¥**

1. âœ… UIè®¾è®¡å·²å®Œæˆ
2. ğŸš§ å®ç°æ ¸å¿ƒäº¤æ˜“å¼•æ“
3. ğŸš§ é›†æˆFutuäº¤æ˜“API
4. ğŸš§ å®ç°è‡ªåŠ¨äº¤æ˜“é€»è¾‘
5. ğŸš§ æ·»åŠ é£æ§ç³»ç»Ÿ

---

**äº¤æ˜“UIè®¾è®¡è¡¥å……å®Œæˆï¼** ğŸ‰

ç°åœ¨ç³»ç»Ÿæ”¯æŒï¼š
- âœ… æŒä»“ç®¡ç†
- âœ… äº¤æ˜“æ‰§è¡Œ
- âœ… è®¢å•ç®¡ç†
- âœ… è‡ªåŠ¨äº¤æ˜“
- âœ… è´¦æˆ·ä¿¡æ¯

å¯ä»¥å¼€å§‹å®ç°äº†ï¼ğŸ’ª